((e,t)=>{function l(e,t){let l=e+t,o=0;for(let e=0;e<l.length;e++)o+=l.charCodeAt(e);let a=987654321+o,s=987654321-o,r=((s=36969*(65535&s)+(s>>16)&4294967295)<<16)+(a=18e3*(65535&a)+(a>>16)&4294967295);return(r/=4294967296)+.5}function o(e){if(e.length<1)return e;if(e.search(", ")>0){let t=e.split(", ");return(t[1]+" "+t[0]).toLowerCase()}return console.error(`Unable to split name ${e} into first and last name`),e}function a(t){if(history.pushState){let l=e.location.protocol+"//"+e.location.host+e.location.pathname+t;e.history.pushState({path:l},"",l)}else e.location.href=e.location.protocol+"//"+e.location.host+e.location.pathname+t}function s(l){if(""===l)return;let o=[];(l=l.toLowerCase()).search(" ")>0?o=l.split(" "):(o[0]=l,o[1]=null,void 0!==o[2]&&(o=o.splice(0,2))),""===o[1]&&(o[1]=null),console.log(e.globalData),console.log(o);let a=[];for(let t of e.globalData){let e=t["Scout's Full Name (last name first):"].trim(),l=[];if(2===(e.match(/\s/g)||[]).length){let t=e.split(" ");l[0]=t[2],l[1]=t[0].slice(0,-1)}else if(e.search(", ")>0){let t=(l=e.split(", "))[0];l[0]=l[1],l[1]=t}else if(1===(e.match(/\s/g)||[]).length)l=e.split(" ");else if(e.search(",")>0){let t=(l=e.split(","))[0];l[0]=l[1],l[1]=t}else l="ERROR",console.error("Unable to split given full name into first and last name");l[0]=l[0].toLowerCase(),l[1]=l[1].toLowerCase(),a.push(l)}let s=[],r=[];for(let e=0;e<a.length;e++)if(null===o[1])if(a[e][0]===o[0]||a[e][1]===o[0])r.push({id:e,score:0});else{let t=compare(o[0],a[e][0])<compare(o[0],a[e][1])?compare(o[0],a[e][0]):compare(o[0],a[e][1]);t<o[0].length/2&&r.push({id:e,score:t+1})}else{if(a[e][0]===o[0]&&a[e][1]===o[1]){r.push({id:e,score:0});break}{let t=compare(o[0],a[e][0])+compare(o[1],a[e][1]);t<(o[0].length+o[1].length)/2&&r.push({id:e,score:t+1})}}if(r.sort((e,t)=>parseFloat(e.score)-parseFloat(t.score)),r[0]){let e=r[0].score;for(let t=0;t<r.length;t++)if(r[t].score===e)s.push(r[t].id);else{if(r[t].score!==e)break;t<3&&s.push(r[t].id)}}if(t("#detail").hide(),t("#results").hide(),0===s.length)t("#no-result").html("Your search - <b>"+l+"</b> - did not match any names."),t("#no-result").show();else{t("#no-result").hide(),t("#results > tbody").html("");for(let l of s){let o=e.globalData[l]["Scout's Full Name (last name first):"];t("#results > tbody").append(`\n                <tr>\n                    <td><a onclick="showfullinfo(${l})">${o}</a></td>\n                    <td>${e.globalData[l]["Scout's Cell Phone"]}</td>\n                </tr>\n            `)}t("#results").show()}}Tabletop.init({key:"15Z9AgrqGNprz2K8c032ZhJ7Wm5bTV-2fJfublK7L1L8",callback:function(a){e.globalData=[];let s=[];for(let t of Object.keys(a))for(let l of a[t].elements){l.patrol=t,l["Scout's Full Name (last name first):"]=o(l["Scout's Full Name (last name first):"].trim()),e.globalData.push(l);let a=l["Scout's E-mail:"].toLowerCase(),r=o(l["父親全名 Father's Full Name (last name first)"]),n=l["Father's E-mail"].toLowerCase(),i=o(l["母親全名 Mother's Full Name (last name first)"]),h=l["Mother's E-mail"].toLowerCase();a.length>2&&(s.push({name:l["Scout's Full Name (last name first):"],email:a}),s.push({name:l["Scout's Full Name (last name first):"].split(" ").reverse().join(" "),email:a})),r.length>2&&n.length>2&&s.push({name:r,email:n}),s.push({name:r.split(" ").reverse().join(" "),email:a}),i.length>2&&h.length>2&&s.push({name:i,email:h}),s.push({name:i.split(" ").reverse().join(" "),email:a})}e.globalData.sort((e,t)=>e["Scout's Full Name (last name first):"]<t["Scout's Full Name (last name first):"]?-1:e["Scout's Full Name (last name first):"]>t["Scout's Full Name (last name first):"]?1:0),console.log(s),function(e){function o(){t("#content").show(),t("#login").hide(),t("#search-query").focus(),t("#spreadsheet-confirm-btn").click(()=>{t("#spreadsheet-confirm").hide(),t("#spreadsheet-content").html('\n                <a href="https://docs.google.com/spreadsheets/d/15Z9AgrqGNprz2K8c032ZhJ7Wm5bTV-2fJfublK7L1L8/edit?usp=drive_web" target="_blank">Edit Spreadsheet</a>\n                <iframe src="https://docs.google.com/spreadsheets/d/15Z9AgrqGNprz2K8c032ZhJ7Wm5bTV-2fJfublK7L1L8/pubhtml?widget=true&amp;headers=false"></iframe>\n            '),t("#spreadsheet").show()})}t("#loading-login").hide();for(let t of e)if(l(t.name,t.email)==localStorage.getItem("userHash"))return void o();t("#login").show(),t("#login-btn").click(()=>{let a=t("#name").val(),s=t("#email").val();for(let t of e)if(a.toLowerCase().trim()==t.name.toLowerCase().trim()&&s.toLowerCase().trim()==t.email.toLowerCase().trim())return localStorage.setItem("userHash",l(a.toLowerCase().trim(),s.toLowerCase().toLowerCase().trim())),void o();alert("Incorrect name or email!")})}(s)},simpleSheet:!1}),e.globalData=[],t(document).ready(()=>{t("#password").focus()}),t("#search-query").keypress(e=>{13===e.keyCode&&t("#search-btn").click()}),t("#search-btn").click(()=>{e.userquery=t("#search-query").val(),a("?type=list&query="+encodeURIComponent(e.userquery)),s(e.userquery)}),"list"===getQuery("type")&&null!==getQuery("query")&&""!==getQuery("query")?(t(".loading").show(),setTimeout(()=>{t("#search-query").val(getQuery("query")),s(getQuery("query")),t(".loading").hide()},1500)):"profile"===getQuery("type")&&null!==getQuery("id")&&""!==getQuery("id")&&(t(".loading").show(),setTimeout(()=>{!function(l,o){!1!==o&&a("?type=profile&id="+encodeURIComponent(l));t("#results").hide();const s=e.globalData[l];t("#detail").show().html("").append(`\n        <br>\n        Name:                               ${s["Scout's Full Name (last name first):"]}<br>\n        Email: <a href="mailto:             ${s["Scout's E-mail:"]}">     ${s["Scout's E-mail:"]}</a><br>\n        Cell Phone: <a href="tel:           ${s["Scout's Cell Phone"]}">  ${s["Scout's Cell Phone"]}</a><br>\n        Home Phone: <a href="tel:           ${s["Scout's Home Phone"]}">  ${s["Scout's Home Phone"]}</a><br>\n        Patrol:                             ${s.patrol}<br><br>\n        Father's Cell Phone: <a href="tel: ${s["Father's Cell Phone"]}"> ${s["Father's Cell Phone"]}</a><br>\n        Father's E-mail: <a href="mailto:  ${s["Father's E-mail"]}">     ${s["Father's E-mail"]}</a><br>\n        Mother's Cell Phone: <a href="tel: ${s["Mother's Cell Phone"]}"> ${s["Mother's Cell Phone"]}</a><br>\n        Mother's E-mail: <a href="mailto:  ${s["Mother's E-mail"]}">     ${s["Mother's E-mail"]}</a><br>\n    `)}(parseInt(getQuery("id"),10),!1),t(".loading").hide()},1500)),t("#email").keypress(e=>{e&&13==e.keyCode&&t("#login-btn").click()})})(window,jQuery);