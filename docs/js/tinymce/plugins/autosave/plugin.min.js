!function(){var e={},t=function(t){for(var n=e[t],r=n.deps,a=n.defn,i=r.length,s=new Array(i),u=0;u<i;++u)s[u]=o(r[u]);var f=a.apply(null,s);if(void 0===f)throw"module ["+t+"] returned undefined";n.instance=f},n=function(t,n,o){if("string"!=typeof t)throw"module id must be a string";if(void 0===n)throw"no dependencies for "+t;if(void 0===o)throw"no definition function for "+t;e[t]={deps:n,defn:o,instance:void 0}},o=function(n){var o=e[n];if(void 0===o)throw"module ["+n+"] was undefined";return void 0===o.instance&&t(n),o.instance},r=n,a=function(e,t){r(e,[],function(){return t})};a("6",tinymce.util.Tools.resolve),r("1",["6"],function(e){return e("tinymce.EditorManager")}),r("2",["6"],function(e){return e("tinymce.PluginManager")}),r("3",["6"],function(e){return e("tinymce.util.LocalStorage")}),r("4",["6"],function(e){return e("tinymce.util.Tools")}),a("5",window),r("0",["1","2","3","4","5"],function(e,t,n,o,r){return e._beforeUnloadHandler=function(){var t;return o.each(e.editors,function(e){e.plugins.autosave&&e.plugins.autosave.storeDraft(),!t&&e.isDirty()&&e.getParam("autosave_ask_before_unload",!0)&&(t=e.translate("You have unsaved changes are you sure you want to navigate away?"))}),t},t.add("autosave",function(t){function a(e,t){return((e=/^(\d+)([ms]?)$/.exec(""+(e||t)))[2]?{s:1e3,m:6e4}[e[2]]:1)*parseInt(e,10)}function i(){var e=parseInt(n.getItem(l+"time"),10)||0;return!((new Date).getTime()-e>g.autosave_retention&&(s(!1),1))}function s(e){n.removeItem(l+"draft"),n.removeItem(l+"time"),!1!==e&&t.fire("RemoveDraft")}function u(){!v()&&t.isDirty()&&(n.setItem(l+"draft",t.getContent({format:"raw",no_events:!0})),n.setItem(l+"time",(new Date).getTime()),t.fire("StoreDraft"))}function f(){i()&&(t.setContent(n.getItem(l+"draft"),{format:"raw"}),t.fire("RestoreDraft"))}function d(){var e=this;e.disabled(!i()),t.on("StoreDraft RestoreDraft RemoveDraft",function(){e.disabled(!i())}),m||(setInterval(function(){t.removed||u()},g.autosave_interval),m=!0)}function c(){t.undoManager.beforeChange(),f(),s(),t.undoManager.add()}function v(e){var n=t.settings.forced_root_block;return""===(e=o.trim(void 0===e?t.getBody().innerHTML:e))||new RegExp("^<"+n+"[^>]*>((Â |&nbsp;|[ \t]|<br[^>]*>)+?|)</"+n+">|<br>$","i").test(e)}var l,m,g=t.settings;l=(l=(l=(l=g.autosave_prefix||"tinymce-autosave-{path}{query}-{id}-").replace(/\{path\}/g,document.location.pathname)).replace(/\{query\}/g,document.location.search)).replace(/\{id\}/g,t.id),g.autosave_interval=a(g.autosave_interval,"30s"),g.autosave_retention=a(g.autosave_retention,"20m"),t.addButton("restoredraft",{title:"Restore last draft",onclick:c,onPostRender:d}),t.addMenuItem("restoredraft",{text:"Restore last draft",onclick:c,onPostRender:d,context:"file"}),!1!==t.settings.autosave_restore_when_empty&&(t.on("init",function(){i()&&v()&&f()}),t.on("saveContent",function(){s()})),r.onbeforeunload=e._beforeUnloadHandler,this.hasDraft=i,this.storeDraft=u,this.restoreDraft=f,this.removeDraft=s,this.isEmpty=v}),function(){}}),o("0")()}();