!function(){var t={},n=function(n){for(var e=t[n],a=e.deps,o=e.defn,i=a.length,d=new Array(i),f=0;f<i;++f)d[f]=r(a[f]);var s=o.apply(null,d);if(void 0===s)throw"module ["+n+"] returned undefined";e.instance=s},e=function(n,e,r){if("string"!=typeof n)throw"module id must be a string";if(void 0===e)throw"no dependencies for "+n;if(void 0===r)throw"no definition function for "+n;t[n]={deps:e,defn:r,instance:void 0}},r=function(e){var r=t[e];if(void 0===r)throw"module ["+e+"] was undefined";return void 0===r.instance&&n(e),r.instance},a=e;(function(t,n){a(t,[],function(){return n})})("7",tinymce.util.Tools.resolve),a("1",["7"],function(t){return t("tinymce.PluginManager")}),a("2",["7"],function(t){return t("tinymce.util.Delay")}),a("3",["7"],function(t){return t("tinymce.util.VK")}),a("8",["7"],function(t){return t("tinymce.dom.TreeWalker")}),a("9",["7"],function(t){return t("tinymce.util.Tools")}),a("a",[],function(){var t=function(t,n,e,r){return n.substr(e-t.end.length-r,t.end.length)===t.end},n=function(t,n,e){return t-n-e.end.length-e.start.length>0};return{findPattern:function(t,n){for(var e=0;e<t.length;e++)if(0===n.indexOf(t[e].start)&&(!t[e].end||n.lastIndexOf(t[e].end)===n.length-t[e].end.length))return t[e]},findEndPattern:function(e,r,a,o){var i,d,f=function(t){return t.sort(function(t,n){return t.start.length>n.start.length?-1:t.start.length<n.start.length?1:0})}(e);for(d=0;d<f.length;d++)if(void 0!==(i=f[d]).end&&t(i,r,a,o)&&n(a,o,i))return i}}}),a("4",["8","9","a"],function(t,n,e){return{applyInlineFormat:function(t,n,r){var a,o,i,d,f,s,l,u,c,h,g;if(a=t.selection,o=t.dom,a.isCollapsed()&&(i=a.getRng(!0),d=i.startContainer,f=i.startOffset,l=d.data,h=!0===r?1:0,3==d.nodeType&&void 0!==(c=e.findEndPattern(n,l,f,h))&&(s=Math.max(0,f-h),-1!==(s=l.lastIndexOf(c.start,s-c.end.length-1))&&((u=o.createRng()).setStart(d,s),u.setEnd(d,f-h),(c=e.findPattern(n,u.toString()))&&c.end&&!(d.data.length<=c.start.length+c.end.length)))))return(g=t.formatter.get(c.format))&&g[0].inline?(t.undoManager.transact(function(){d=function(t,n,e,r,a){return(t=r>0?t.splitText(r):t).splitText(e-r-a),t.deleteData(0,n.start.length),t.deleteData(t.data.length-n.end.length,n.end.length),t}(d,c,f,s,h),t.formatter.apply(c.format,{},d)}),d):void 0},applyBlockFormat:function(r,a){var o,i,d,f,s,l,u,c,h,g,m;if(o=r.selection,i=r.dom,o.isCollapsed()&&(u=i.getParent(o.getStart(),"p"))){for(h=new t(u,u);s=h.next();)if(3==s.nodeType){f=s;break}if(f){if(!(c=e.findPattern(a,f.data)))return;if(d=(g=o.getRng(!0)).startContainer,m=g.startOffset,f==d&&(m=Math.max(0,m-c.start.length)),n.trim(f.data).length==c.start.length)return;c.format&&(l=r.formatter.get(c.format))&&l[0].block&&(f.deleteData(0,c.start.length),r.formatter.apply(c.format,{},f),g.setStart(d,m),g.collapse(!0),o.setRng(g)),c.cmd&&r.undoManager.transact(function(){f.deleteData(0,c.start.length),r.execCommand(c.cmd)})}}}}}),a("5",["3","4"],function(t,n){var e=function(t,n,e){for(var r=0;r<t.length;r++)if(e(t[r],n))return!0};return{handleEnter:function(t,e){var r,a;(a=n.applyInlineFormat(t,e,!1))&&((r=t.dom.createRng()).setStart(a,a.data.length),r.setEnd(a,a.data.length),t.selection.setRng(r)),n.applyBlockFormat(t,e)},handleInlineKey:function(t,e){var r,a,o,i,d;(r=n.applyInlineFormat(t,e,!0))&&(d=t.dom,a=r.data.slice(-1),/[\u00a0 ]/.test(a)&&(r.deleteData(r.data.length-1,1),o=d.doc.createTextNode(a),r.nextSibling?d.insertAfter(o,r.nextSibling):r.parentNode.appendChild(o),(i=d.createRng()).setStart(o,1),i.setEnd(o,1),t.selection.setRng(i)))},checkCharCode:function(t,n){return e(t,n,function(t,n){return t.charCodeAt(0)===n.charCode})},checkKeyCode:function(n,r){return e(n,r,function(n,e){return n===e.keyCode&&!1===t.modifierPressed(e)})}}}),a("6",[],function(){var t=[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}];return{getPatterns:function(n){return void 0!==n.textpattern_patterns?n.textpattern_patterns:t}}}),a("0",["1","2","3","4","5","6"],function(t,n,e,r,a,o){return t.add("textpattern",function(t){var r=o.getPatterns(t.settings),i=[",",".",";",":","!","?"],d=[32];t.on("keydown",function(n){13!==n.keyCode||e.modifierPressed(n)||a.handleEnter(t,r)},!0),t.on("keyup",function(n){a.checkKeyCode(d,n)&&a.handleInlineKey(t,r)}),t.on("keypress",function(e){a.checkCharCode(i,e)&&n.setEditorTimeout(t,function(){a.handleInlineKey(t,r)})}),this.setPatterns=function(t){r=t},this.getPatterns=function(){return r}}),function(){}}),r("0")()}();