<!DOCTYPE html>
<html>

<head>

    <script class="singulr-ignore" src="js/singulr-page.js"></script>

    <title>Event - Troop 485</title>
    <style>
        .hidden {
            display: none;
        }
    </style>
</head>

<body>
<div class="alert alert-info alert-dismissible alert-visible" role="alert">
  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
  <span id="edit-alert">You can <a id="edit" class="alert-link">edit this page</a>.</span>
</div>
    <div class="container">

        <div class="row">
            <div class="box">
                <div class="col-lg-12">
                    <hr>
                    <h2 class="intro-text text-center editable" id="event-title">Loading...</h2>
                    <hr>
                </div>
                <div class="col-md-12" id="event-description-box">
                    <div class="editable" id="event-description">Loading...</div>
                </div>

                <div class="clearfix"></div>
            </div>
        </div>

    </div>
    <!-- /.container -->
    <script src='https://cdn.tinymce.com/4/tinymce.min.js'></script>
    <script>
        auth(function(user) {
            firebase.database().ref('/events/' + getQuery("event")).once('value').then(function(snapshot) {
                var data = snapshot.val();

                $("#event-title").html(data.title);
                $("#event-description").html(data.description)

            });

        }, function() {
            Singulr.loadPage('login.html?redir=event.html' + encodeURIComponent(window.location.search));
        });
        $("#edit").click(function() {
            $("#edit-alert").html("Click on some text to edit it. After you edit some text, click save changes on the toolbar that pops up. This will save the text only one the paragraph you selected. Or <a id='view'>View this page</a>.");
            $("#view").click(function() {
                window.location.reload();
            });
            tinymce.init({
              selector: 'h2.editable',
              inline: true,
              plugins : [
                  "textcolor colorpicker link"
                  ],
              toolbar: 'undo redo | forecolor backcolor | link | save',
              menubar: false,
              setup: function(editor) {
                    editor.addButton('save', {
                        text: 'Save Changes',
                        icon: false,
                        onclick: function() {
                            console.log(editor.getContent());
                            console.log(editor.id);
                            firebase.database().ref("/events/" + getQuery("event") + "/" + editor.id.replace("event-", "") + "/").set(editor.getContent());
                        }
                    });
                }
            });
            tinymce.init({
                selector: 'div.editable',
                inline: true,
                plugins: [
                    'advlist autolink lists link image charmap print preview',
                    'searchreplace visualblocks fullscreen textcolor colorpicker',
                    'insertdatetime media table contextmenu paste imagetools'
                ],
                removed_menuitems: 'newdocument',
                setup: function(editor) {
                    editor.addButton('save', {
                        text: 'Save Changes',
                        icon: false,
                        onclick: function() {
                            console.log(editor.getContent());
                            console.log(editor.id);
                            firebase.database().ref("/events/" + getQuery("event") + "/" + editor.id.replace("event-", "") + "/").set(editor.getContent());
                        }
                    });
                },
                toolbar: 'insertfile undo redo | styleselect | bold italic | forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | save'
            });

        });
    </script>

    </div>
</body>
